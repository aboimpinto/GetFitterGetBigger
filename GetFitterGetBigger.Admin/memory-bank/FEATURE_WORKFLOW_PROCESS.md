# Feature Workflow Process

This document defines the complete lifecycle of features, from inception to release, using a state-based folder structure.

## Feature States and Folder Structure

```
memory-bank/features/
├── feature-status.md       # Main dashboard (manually maintained)
├── NEXT_FEATURE_ID.txt     # Auto-increment counter
├── 0-SUBMITTED/            # Features propagated from API, needs refinement
├── 1-READY_TO_DEVELOP/     # Features planned and ready to implement
├── 2-IN_PROGRESS/          # Features currently being developed
├── 3-COMPLETED/            # Features fully implemented and tested
├── 4-BLOCKED/              # Features blocked by dependencies
└── 5-SKIPPED/              # Features deferred or cancelled
```

## Important Files and Maintenance

### Core Files (Source of Truth)
These files MUST be maintained and are the authoritative source:

1. **feature-status.md**
   - **Purpose**: Main dashboard showing all features
   - **Updated by**: Developer implementing the feature
   - **When**: When moving features between stages
   - **Required**: YES

2. **NEXT_FEATURE_ID.txt**
   - **Purpose**: Tracks next available feature ID
   - **Updated by**: Automatic increment when creating features
   - **When**: After assigning a new feature ID
   - **Required**: YES

3. **Individual feature files** (in each feature folder):
   - `feature-description.md` - Core feature details
   - `feature-tasks.md` - Task breakdown and tracking
   - **Updated by**: Developer during implementation
   - **When**: As work progresses
   - **Required**: YES

### Optional/Generated Files
These files can be generated from folder contents and are NOT required:

1. **FEATURE_ID_REGISTRY.md** - Can be generated by scanning folders
2. **Analysis/Migration reports** - Temporary, delete after use
3. **Summary reports** - Can be generated on demand

### File Naming Convention
All feature folders MUST follow: `FEAT-XXX-<feature-name>`
- Example: `FEAT-001-service-unit-tests`
- The feature ID is visible in the folder name
- This eliminates the need for separate ID registries

## Feature Lifecycle

### 0. Feature Submission (SUBMITTED)
When features are propagated from API changes:
1. Root folder creates: `memory-bank/features/0-SUBMITTED/[feature-name]/`
2. Contains only `feature-description.md` with:
   - API endpoint changes
   - Request/response formats
   - Business context
   - Potential impact on Admin UI
3. NO task files yet - these are created during refinement

### 1. Feature Refinement & Planning (READY_TO_DEVELOP)
When the team is ready to implement:
1. Review the submitted feature documentation
2. Analyze Admin-specific requirements
3. Create `feature-tasks.md` with UI implementation tasks
4. Move entire folder from `0-SUBMITTED` to `1-READY_TO_DEVELOP`
5. The team decides when this transition happens based on:
   - Current priorities
   - Resource availability
   - Dependencies readiness

#### Important Note on Feature Creation
**ALL features MUST start in 0-SUBMITTED**, even Admin-specific features:
1. Create in `0-SUBMITTED` with basic description
2. Refine and add tasks when ready
3. Move to `1-READY_TO_DEVELOP` after planning

This ensures consistent workflow tracking. Direct creation in 1-READY_TO_DEVELOP is NOT allowed.

### 2. Feature Development (IN_PROGRESS)
When development begins:
1. Move entire feature folder from `1-READY_TO_DEVELOP` to `2-IN_PROGRESS`
2. Create feature branch as specified in tasks file
3. Update task statuses as work progresses
4. Add commit hashes to completed tasks
5. Include any test scripts created during development

**Folder Structure Example:**
```
2-IN_PROGRESS/
└── exercise-management/
    ├── feature-description.md
    ├── feature-tasks.md (with commit hashes)
    ├── ui-mockups.png
    └── test-exercise-crud.sh
```

### 3. Feature Completion (COMPLETED)
When all tasks are implemented and tested:
1. Ensure all tests are green
2. Get user acceptance (if manual testing phase)
3. Calculate final time metrics in feature-tasks.md:
   - Sum all actual durations
   - Calculate AI assistance impact percentage
   - Add final summary of time savings
4. Move entire folder from `2-IN_PROGRESS` to `3-COMPLETED`
5. Add completion date and time metrics to feature-description.md
6. Feature is now eligible for next PI release

### 4. Blocked Features (BLOCKED)
If a feature cannot proceed:
1. Move folder from current location to `4-BLOCKED`
2. Add `BLOCKED_REASON.md` file explaining:
   - What is blocking the feature
   - Dependencies needed
   - Link to blocking bug/feature
3. When unblocked, move back to `2-IN_PROGRESS`

### 5. Skipped Features (SKIPPED)
If a feature is deferred or cancelled:
1. Move folder to `5-SKIPPED`
2. Add `SKIPPED_REASON.md` file explaining:
   - Why feature was skipped
   - Future considerations
   - Any partial work completed

## File Templates

### feature-description.md Template
```markdown
# Feature: [Feature Name]

## Feature ID: FEAT-[XXX]
## Created: [Date]
## Status: [Current State]
## Target PI: [PI-YYYY-QX]

## Description
[Detailed description of the feature]

## Business Value
[Why this feature is important]

## User Stories
- As a [user type], I want to [action] so that [benefit]

## Acceptance Criteria
- [ ] Criteria 1
- [ ] Criteria 2

## Technical Specifications
[Any technical details, UI/UX specs, etc.]

## Dependencies
- [List any dependencies]

## Notes
[Additional context or considerations]
```

### feature-tasks.md Template
```markdown
# [Feature Name] Implementation Tasks

## Feature Branch: `feature/[branch-name]`
## Estimated Total Time: [X days / Y hours]
## Actual Total Time: [To be calculated at completion]

### Task Categories
[Tasks organized by logical groupings with time estimates]

### Progress Tracking
- All tasks start as `[ReadyToDevelop]` with time estimate
- Update to `[InProgress: Started: YYYY-MM-DD HH:MM]` when starting
- Update to `[Implemented: <hash> | Started: <time> | Finished: <time> | Duration: Xh Ym]` when complete
- Use `[Blocked: reason]` if blocked

### Tasks
[Detailed task list following FEATURE_IMPLEMENTATION_PROCESS.md with estimates]

### Time Tracking Summary
- **Total Estimated Time:** [Sum of all estimates]
- **Total Actual Time:** [To be calculated from task durations]
- **AI Assistance Impact:** [% reduction in time]
- **Implementation Started:** [First task start time]
- **Implementation Completed:** [Last task finish time]
```

## State Transition Rules

1. **To IN_PROGRESS**: Only when developer is actively working on it
2. **To COMPLETED**: Only when ALL tasks are implemented and tests pass
3. **To BLOCKED**: As soon as a blocking issue is identified
4. **To SKIPPED**: Only with explicit user decision
5. **From BLOCKED**: Only when blocking issue is resolved
6. **From SKIPPED**: Rare, but possible if feature is revived

## Integration with Release Process

- Only features in `3-COMPLETED` are included in releases
- Features must be completed before PI end date
- Release notes are generated from completed features
- Each feature folder contains all documentation needed for release notes

## Best Practices

1. **One Feature Per Folder**: Keep features atomic and focused
2. **Complete Documentation**: All files should be comprehensive
3. **Test Scripts**: Include all test scripts in the feature folder
4. **Clean Transitions**: Move entire folder, don't leave artifacts
5. **Audit Trail**: Preserve all history in the moved files
6. **Feature ID Usage**: Always use Feature IDs (FEAT-XXX) when referencing features:
   - In bug reports: "Related Feature: FEAT-001"
   - In blocked reasons: "Blocked by FEAT-002"
   - In documentation: "See FEAT-003 for details"
   - Never use folder paths or feature names alone

## Monitoring and Reporting

To get current feature status:
- Count folders in each state directory
- Generate reports from feature-description.md files
- Track velocity by completion dates
- Identify bottlenecks in BLOCKED folder
- Generate AI impact reports:
  - Average time reduction percentage across features
  - Total hours saved with AI assistance
  - Productivity metrics comparison
  - Feature complexity vs time savings analysis

## Cleanup Policy

- COMPLETED features older than 2 PIs can be archived
- SKIPPED features older than 4 PIs can be archived
- Archive location: `memory-bank/archive/features/[year]/`

## Common Mistakes to Avoid

1. **Starting work without proper folder structure**: Always create the feature folder in the appropriate state directory BEFORE starting implementation
2. **Creating task files in wrong location**: Task files must be inside the feature folder, not directly in `memory-bank/features/`
3. **Not moving folders between states**: Remember to move the entire feature folder as it progresses through states
4. **Missing feature-description.md**: Both description and tasks files are required from the start

### Example of Incorrect Start:
```
❌ memory-bank/features/my-feature-tasks.md  # Wrong location
```

### Example of Correct Start:
```
✅ memory-bank/features/1-READY_TO_DEVELOP/my-feature/
   ├── feature-description.md
   └── feature-tasks.md
```